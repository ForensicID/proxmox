apt install icinga2 monitoring-plugins icinga2-ido-pgsql -y

sudo su - postgres
psql
create database icinga2;
create user icinga2 with password 'Skill25';
grant all privileges on database icinga2 to icinga2;



/etc/icinga2/features-available/ido-pgsql.conf
/**
 * The db_ido_pgsql library implements IDO functionality
 * for PostgreSQL.
 */

library "db_ido_pgsql"

object IdoPgsqlConnection "ido-pgsql" {
  user = "icinga2",
  password = "Skill25",
  host = "172.17.25.2",
  database = "icinga2"
}

psql -h 172.17.25.2 -U icinga2 -d icinga2 < /usr/share/icinga2-ido-pgsql/schema/pgsql.sql

icinga2 feature enable ido-pgsql
systemctl restart icinga2.service
systemctl status icinga2.service

icinga2 api setup
systemctl restart icinga2.service
apt install icingaweb2 libapache2-mod-php icingacli -y

sudo su - postgres
psql
create database icingaweb2;
create user icingaweb2 with password 'Skill25';
grant all privileges on database icingaweb2 to icingaweb2;


psql -h 127.0.0.1 -U icinga -d icinga < /usr/share/icinga2-ido-pgsql/schema/pgsql.sql
